import json

from django.views import View
from django.http  import JsonResponse, HttpResponse

from .models      import Comment
from account.models import Account
from account.views import LoginConfirm

class CommentView(View):
	@LoginConfirm
	def post(self, request):
		try:
			data = json.loads(request.body)
			if Account.objects.filter(user_id = data['user_id']).exists():
				Comment.objects.create(
						user_id		= data['user_id'],
						content		= data['content'],
				).save()
				return HttpResponse(status=200)
			return JsonResponse({"message":"USER_ID_NOT_FOUND"}, status=400)
		except KeyError:
			return JsonResponse({"message":"INVALID_KEY"}, status=401)
	@LoginConfirm
	def get(self, request):
		comment_data = Comment.objects.values()
		return JsonResponse({'Comment':list(comment_data)},status=200)
